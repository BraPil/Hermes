from pathlib import Path

code = """\"\"\"PoC entry point that exercises Historical + Technical agents.\"\"\"\n\nfrom __future__ import annotations\n\nfrom datetime import datetime\nfrom pathlib import Path\nimport importlib.util\nimport json\n\nROOT = Path(__file__).resolve().parent\n\n\ndef _load_agent_class(module_name: str, class_name: str):\n    module_path = ROOT / \"agents\" / f\"{module_name}.py\"\n    spec = importlib.util.spec_from_file_location(f\"agents.{module_name}\", module_path)\n    module = importlib.util.module_from_spec(spec)  # type: ignore[attr-defined]\n    spec.loader.exec_module(module)  # type: ignore[attr-defined]\n    return getattr(module, class_name)\n\n\nWATCHLIST = [\n    \"SQQQ\",\n    \"UVXY\",\n    \"SPXU\",\n    \"RNA\",\n    \"DYN\",\n    \"MSFT\",\n    \"GOOGL\",\n    \"INTC\",\n    \"AMD\",\n    \"GLD\",\n    \"RGTI\",\n    \"QBTS\",\n    \"IONQ\",\n    \"QUBT\",\n    \"QMCO\",\n    \"BTC-USD\",\n]\n\n\ndef run_one(as_of: datetime) -> list[dict]:\n    hist_cls = _load_agent_class(\"historical\", \"YFinanceHistoricalPerformanceAgent\")\n    tech_cls = _load_agent_class(\"technical\", \"YFinanceTechnicalIndicatorAgent\")\n    hist = hist_cls()\n    tech = tech_cls()\n    results: list[dict] = []\n    for symbol in WATCHLIST:\n        hv = hist.compute_features(symbol, as_of)\n        tv = tech.compute_features(symbol, as_of)\n        results.append(\n            {\n                \"symbol\": symbol,\n                \"timestamp\": as_of.isoformat(),\n                \"historical\": [fv.features for fv in hv],\n                \"technical\": tv.features,\n            }\n        )\n    return results\n\n\ndef main() -> None:\n    now = datetime.utcnow()\n    results = run_one(now)\n    out_dir = ROOT / \"outputs\"\n    out_dir.mkdir(exist_ok=True)\n    path = out_dir / f\"run_agents_poc_{now:%Y%m%d_%H%M%S}.json\"\n    path.write_text(json.dumps(results, indent=2))\n    print(f\"Saved {path}\")\n\n\nif __name__ == \"__main__\":\n    main()\n"""
\n+Path(\"run_agents_poc.py\").write_text(code)\n"""

